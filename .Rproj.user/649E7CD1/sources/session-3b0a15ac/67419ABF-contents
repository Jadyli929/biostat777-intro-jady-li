---
title: "Data Analysis"
---

```         
-   You must describe what is the question you aim to answer with the data and data analysis.

-   You must describe who is the intended audience for the data analysis.

-   You must describe and link to where the original data come from that you chose.

-   You must include a link to a data dictionary for the data or create one inside the webpage.

-   Your analysis must include some minimal form of data wrangling with you using at least five different functions from `dplyr` or `tidyr`.

-   Your analysis should include at least three plots with you using at least three different `geom_*()` functions from `ggplot2` (or another package with `geom_*()` functions).

-   Plots should have titles, subtitles, captions, and human-understandable axis labels.

-   At least one plot should using a type of faceting (`facet_grid()` or `facet_wrap()`).

-   Your analysis must include one image or table (not one you created yourself, but one you have saved locally or one from the web).

-   Your analysis must include at least two different [callout blocks](https://quarto.org/docs/authoring/callouts.html).

-   Your analysis must include a `.bib` file, which you use to reference at least three unique citations. For example, it could be to a website or paper from where the original data came from or it could be to a paper describing a method you are using to analyze the data.

-   Your analysis must include the use of at least 1 [margin content](https://quarto.org/docs/authoring/article-layout.html#margin-content).

-   You must summarize your analysis and/or results with a paragraph (4-6 sentences).

-   At the end of the data analysis, list out each of the functions you used from each of the packages (`dplyr`, `tidyr`, and `ggplot2`) to help the TA with respect to making sure you met all the requirements described above.
```

## Background:

Each person is composed of many types of emotions: fear, anger, happiness, sadness, etc. As we grow up, we might experiencing more complex and more diverse emotions. Without appropriate skills and abilities, we might lose control in dealing with our emotions and might have the risk of experiencing mental disorders.

The awareness that mental health is as important as physiological health is increasing in recent days. With the world developing so rapidly, there are improved treatments and diagnosis, as well as diverse services provided around world to help improve people's mental well-being. In order to help better support human beings' mental health, it is important to understand the trend of mental health status, so that better future treatments, policies, and services could be developed.

![Inside Out 2](picture/inside_out2.jpg){fig-align="center"}

## Research Question:

1.  How does the trend of prevalence of mental health disorders change with time?

2.  How does the prevalence of mental health disorders differ across the world ?

### 

## Target Audience:

The intended audience for this analysis are researchers who are interested in knowing the trend of mental health disorders around the world in order to better inform future policy-making and/or treatments.

## About Data:

[Link to Data](https://data.world/vizzup/mental-health-depression-disorder-data)

## Data Analysis:

```{r}
library("readxl")
library(tidyverse)
library(ggplot2)
```

```{r}
#| echo: false
#| message: false

excel_file <- "/Users/jadyli/Desktop/Stat Programming/Project1 Quarto Website/data/Mental health Depression disorder Data.xlsx"

sheet_name <- excel_sheets(excel_file) #extract each sheet's name inside the excel file
for(i in sheet_name){ 
  data <- read_excel(excel_file, sheet = i)
  csv_file <- paste0("/Users/jadyli/Desktop/Stat Programming/Project1 Quarto Website/data/",i, ".csv")
  write.csv(data, csv_file, row.names = FALSE)
} #create a seperate csv file for each sheet in the excel

df1 <- read.csv("/Users/jadyli/Desktop/Stat Programming/Project1 Quarto Website/data/prevalence-by-mental-and-substa.csv")
df2 <- read.csv("/Users/jadyli/Desktop/Stat Programming/Project1 Quarto Website/data/prevalence-of-depression-by-age.csv", check.names = FALSE)
```

```{r}
prevalence <- df1 |> 
  summarise(across(-c(1:3), ~ mean(.x, na.rm = TRUE))) # calculate average percent for each type of mental disorder

names(prevalence) <- str_extract(names(prevalence), "^[^\\(]+") #get rid of parenthesis in disorder name

prevalence <- prevalence |> 
  pivot_longer(
    cols = everything(),
    names_to = "Mental Disorder Type",
    values_to = "Average Percent"
  ) # change to long data

prevalence <- as.data.frame(prevalence) |> 
  arrange(desc(`Average Percent`))

ggplot(prevalence, aes(y = reorder(`Mental Disorder Type`, `Average Percent`), x = `Average Percent`))+
    geom_bar(stat = "identity", fill = "skyblue")+
    labs(title = "Prevalance of Mental Disorder Types Around World", y = NULL)+
  theme_minimal()+
  theme(plot.title = element_text(hjust = 0.5, face = "bold", size=15))

```

## Reference:

<https://ourworldindata.org/mental-health#all-charts>
