title="Correlation Matrix of Common Mental Disorders Across World",
mar = c(0, 0, 1, 0)
)
mtext("Subtitle: Analysis of Global Data",
side = 3,           # Top side
line = 0.5,         # Position the subtitle
cex = 0.8           # Subtitle font size
)
names(df1) <- str_remove(names(df1), "disorders?") # Remove 'disorder' or 'disorders' from column names
cor_matrix <- cor(df1[,-c(1:3)])
head(round(cor_matrix,2))
par(mar = c(5, 4, 2, 2)) # Adjust bottom, left, top, and right margins
corrplot.mixed(cor_matrix,
order = 'AOE',
tl.cex = 0.6,
sub="subtitle",
title="Correlation Matrix of Common Mental Disorders Across World",
mar = c(0, 0, 2, 0)
)
mtext("Subtitle: Analysis of Global Data",
side = 3,           # Top side
line = 0.5,         # Position the subtitle
cex = 0.8           # Subtitle font size
)
names(df1) <- str_remove(names(df1), "disorders?") # Remove 'disorder' or 'disorders' from column names
cor_matrix <- cor(df1[,-c(1:3)])
head(round(cor_matrix,2))
par(mar = c(5, 4, 2, 2)) # Adjust bottom, left, top, and right margins
corrplot.mixed(cor_matrix,
order = 'AOE',
tl.cex = 0.6,
sub="subtitle",
title="Correlation Matrix of Common Mental Disorders Across World",
mar = c(0, 0, 3, 0)
)
mtext("Subtitle: Analysis of Global Data",
side = 3,           # Top side
line = 0.5,         # Position the subtitle
cex = 0.8           # Subtitle font size
)
names(df1) <- str_remove(names(df1), "disorders?") # Remove 'disorder' or 'disorders' from column names
cor_matrix <- cor(df1[,-c(1:3)])
head(round(cor_matrix,2))
par(mar = c(5, 4, 1, 2)) # Adjust bottom, left, top, and right margins
corrplot.mixed(cor_matrix,
order = 'AOE',
tl.cex = 0.6,
sub="subtitle",
title="Correlation Matrix of Common Mental Disorders Across World",
mar = c(0, 0, 3, 0)
)
mtext("Subtitle: Analysis of Global Data",
side = 3,           # Top side
line = 0.5,         # Position the subtitle
cex = 0.8           # Subtitle font size
)
names(df1) <- str_remove(names(df1), "disorders?") # Remove 'disorder' or 'disorders' from column names
cor_matrix <- cor(df1[,-c(1:3)])
head(round(cor_matrix,2))
par(mar = c(5, 4, 1, 2)) # Adjust bottom, left, top, and right margins
corrplot.mixed(cor_matrix,
order = 'AOE',
tl.cex = 0.6,
sub="subtitle",
title="Correlation Matrix of Common Mental Disorders Across World",
mar = c(0, 0, 1, 0)
)
mtext("Subtitle: Analysis of Global Data",
side = 3,           # Top side
line = 0.5,         # Position the subtitle
cex = 0.8           # Subtitle font size
)
names(df1) <- str_remove(names(df1), "disorders?") # Remove 'disorder' or 'disorders' from column names
cor_matrix <- cor(df1[,-c(1:3)])
head(round(cor_matrix,2))
par(mar = c(5, 4, 2, 2)) # Adjust bottom, left, top, and right margins
corrplot.mixed(cor_matrix,
order = 'AOE',
tl.cex = 0.6,
sub="subtitle",
title="Correlation Matrix of Common Mental Disorders Across World",
mar = c(0, 0, 1, 0)
)
mtext("Subtitle: Analysis of Global Data",
side = 3,           # Top side
line = 0.5,         # Position the subtitle
cex = 0.8           # Subtitle font size
)
names(df1) <- str_remove(names(df1), "disorders?") # Remove 'disorder' or 'disorders' from column names
cor_matrix <- cor(df1[,-c(1:3)])
head(round(cor_matrix,2))
par(mar = c(5, 4, 3, 2)) # Adjust bottom, left, top, and right margins
corrplot.mixed(cor_matrix,
order = 'AOE',
tl.cex = 0.6,
sub="subtitle",
title="Correlation Matrix of Common Mental Disorders Across World",
mar = c(0, 0, 1, 0)
)
mtext("Subtitle: Analysis of Global Data",
side = 3,           # Top side
line = 0.5,         # Position the subtitle
cex = 0.8           # Subtitle font size
)
names(df1) <- str_remove(names(df1), "disorders?") # Remove 'disorder' or 'disorders' from column names
cor_matrix <- cor(df1[,-c(1:3)])
head(round(cor_matrix,2))
par(mar = c(5, 4, 3, 2)) # Adjust bottom, left, top, and right margins
corrplot.mixed(cor_matrix,
order = 'AOE',
tl.cex = 0.6,
sub="subtitle",
title="Correlation Matrix of Common Mental Disorders Across World",
mar = c(0, 0, 0, 0)
)
mtext("Subtitle: Analysis of Global Data",
side = 3,           # Top side
line = 0.5,         # Position the subtitle
cex = 0.8           # Subtitle font size
)
names(df1) <- str_remove(names(df1), "disorders?") # Remove 'disorder' or 'disorders' from column names
cor_matrix <- cor(df1[,-c(1:3)])
head(round(cor_matrix,2))
par(mar = c(5, 4, 3, 2)) # Adjust bottom, left, top, and right margins
corrplot.mixed(cor_matrix,
order = 'AOE',
tl.cex = 0.6,
sub="subtitle",
title="Correlation Matrix of Common Mental Disorders Across World",
mar = c(0, 0, 2, 0)
)
mtext("Subtitle: Analysis of Global Data",
side = 3,           # Top side
line = 0.5,         # Position the subtitle
cex = 0.8           # Subtitle font size
)
names(df1) <- str_remove(names(df1), "disorders?") # Remove 'disorder' or 'disorders' from column names
cor_matrix <- cor(df1[,-c(1:3)])
head(round(cor_matrix,2))
par(mar = c(5, 4, 4, 2)) # Adjust bottom, left, top, and right margins
corrplot.mixed(cor_matrix,
order = 'AOE',
tl.cex = 0.6,
sub="subtitle",
title="Correlation Matrix of Common Mental Disorders Across World",
mar = c(0, 0, 2, 0)
)
mtext("Subtitle: Analysis of Global Data",
side = 3,           # Top side
line = 0.5,         # Position the subtitle
cex = 0.8           # Subtitle font size
)
names(df1) <- str_remove(names(df1), "disorders?") # Remove 'disorder' or 'disorders' from column names
cor_matrix <- cor(df1[,-c(1:3)])
head(round(cor_matrix,2))
par(mar = c(5, 4, 3, 2)) # Adjust bottom, left, top, and right margins
corrplot.mixed(cor_matrix,
order = 'AOE',
tl.cex = 0.6,
sub="subtitle",
title="Correlation Matrix of Common Mental Disorders Across World",
mar = c(0, 0, 2, 0)
)
mtext("Subtitle: Analysis of Global Data",
side = 3,           # Top side
line = 0.5,         # Position the subtitle
cex = 0.8           # Subtitle font size
)
names(df1) <- str_remove(names(df1), "disorders?") # Remove 'disorder' or 'disorders' from column names
cor_matrix <- cor(df1[,-c(1:3)])
head(round(cor_matrix,2))
par(mar = c(5, 4, 3, 2)) # Adjust bottom, left, top, and right margins
corrplot.mixed(cor_matrix,
order = 'AOE',
tl.cex = 0.6,
sub="subtitle",
title="Correlation Matrix of Common Mental Disorders Across World",
mar = c(0, 0, 3, 0)
)
mtext("Subtitle: Analysis of Global Data",
side = 3,           # Top side
line = 0.5,         # Position the subtitle
cex = 0.8           # Subtitle font size
)
names(df1) <- str_remove(names(df1), "disorders?") # Remove 'disorder' or 'disorders' from column names
cor_matrix <- cor(df1[,-c(1:3)])
head(round(cor_matrix,2))
par(mar = c(5, 4, 3, 2)) # Adjust bottom, left, top, and right margins
corrplot.mixed(cor_matrix,
order = 'AOE',
tl.cex = 0.6,
sub="subtitle",
title="Correlation Matrix of Common Mental Disorders Across World",
mar = c(0, 0, 2.5, 0)
)
mtext("Subtitle: Analysis of Global Data",
side = 3,           # Top side
line = 0.5,         # Position the subtitle
cex = 0.8           # Subtitle font size
)
names(df1) <- str_remove(names(df1), "disorders?") # Remove 'disorder' or 'disorders' from column names
cor_matrix <- cor(df1[,-c(1:3)])
head(round(cor_matrix,2))
par(mar = c(5, 4, 4, 2)) # Adjust bottom, left, top, and right margins
corrplot.mixed(cor_matrix,
order = 'AOE',
tl.cex = 0.6,
sub="subtitle",
title="Correlation Matrix of Common Mental Disorders Across World",
mar = c(0, 0, 2.5, 0)
)
mtext("Subtitle: Analysis of Global Data",
side = 3,           # Top side
line = 0.5,         # Position the subtitle
cex = 0.8           # Subtitle font size
)
names(df1) <- str_remove(names(df1), "disorders?") # Remove 'disorder' or 'disorders' from column names
cor_matrix <- cor(df1[,-c(1:3)])
head(round(cor_matrix,2))
par(mar = c(5, 4, 3, 2)) # Adjust bottom, left, top, and right margins
corrplot.mixed(cor_matrix,
order = 'AOE',
tl.cex = 0.6,
sub="subtitle",
title="Correlation Matrix of Common Mental Disorders Across World",
mar = c(0, 0, 2.5, 0)
)
mtext("Subtitle: Analysis of Global Data",
side = 3,           # Top side
line = 0.5,         # Position the subtitle
cex = 0.8           # Subtitle font size
)
names(df1) <- str_remove(names(df1), "disorders?") # Remove 'disorder' or 'disorders' from column names
cor_matrix <- cor(df1[,-c(1:3)])
head(round(cor_matrix,2))
par(mar = c(5, 4, 3, 2)) # Adjust bottom, left, top, and right margins
corrplot.mixed(cor_matrix,
order = 'AOE',
tl.cex = 0.6,
sub="subtitle",
title="Correlation Matrix of Common Mental Disorders Across World",
mar = c(0, 0, 2.3, 0)
)
mtext("Subtitle: Analysis of Global Data",
side = 3,           # Top side
line = 0.5,         # Position the subtitle
cex = 0.8           # Subtitle font size
)
names(df1) <- str_remove(names(df1), "disorders?") # Remove 'disorder' or 'disorders' from column names
cor_matrix <- cor(df1[,-c(1:3)])
head(round(cor_matrix,2))
par(mar = c(5, 4, 3, 2)) # Adjust bottom, left, top, and right margins
corrplot.mixed(cor_matrix,
order = 'AOE',
tl.cex = 0.6,
sub="subtitle",
title="Correlation Matrix of Common Mental Disorders Across World",
mar = c(0, 0, 2.3, 0)
)
mtext("Both size and numerica values of correlation are shown:",
side = 3,           # Top side
line = 0.5,         # Position the subtitle
cex = 0.8           # Subtitle font size
)
names(df1) <- str_remove(names(df1), "disorders?") # Remove 'disorder' or 'disorders' from column names
cor_matrix <- cor(df1[,-c(1:3)])
head(round(cor_matrix,2))
par(mar = c(5, 4, 3, 2)) # Adjust bottom, left, top, and right margins
corrplot.mixed(cor_matrix,
order = 'AOE',
tl.cex = 0.6,
sub="subtitle",
title="Correlation Matrix of Common Mental Disorders Across World",
mar = c(0, 0, 2.3, 0)
)
mtext("Both size and numerica values of correlation are shown:", # add subtitle
side = 3,           # Top side
line = 0.5,         # Position the subtitle
cex = 0.8           # Subtitle font size
)
mtext("Data Source: World Health Organization (WHO)", # add caption
side = 1,           # Bottom side
line = 3,           # Position the caption
cex = 0.8           # Caption font size
)
names(df1) <- str_remove(names(df1), "disorders?") # Remove 'disorder' or 'disorders' from column names
cor_matrix <- cor(df1[,-c(1:3)])
head(round(cor_matrix,2))
par(mar = c(5, 4, 3, 2)) # Adjust bottom, left, top, and right margins
corrplot.mixed(cor_matrix,
order = 'AOE',
tl.cex = 0.6,
sub ="subtitle",
title="Correlation Matrix of Common Mental Disorders Across World",
mar = c(0, 0, 2.3, 0)
)
mtext("Both size and numerica values of correlation are shown:", # add subtitle
side = 3,           # Top side
line = 0.5,         # Position the subtitle
cex = 0.8           # Subtitle font size
)
mtext("Data Source: World Health Organization (WHO)", # add caption
side = 1,           # Bottom side
line = 4,           # Position the caption
adj = 1,            # Right-align the text
cex = 0.8           # Caption font size
)
names(df1) <- str_remove(names(df1), "disorders?") # Remove 'disorder' or 'disorders' from column names
cor_matrix <- cor(df1[,-c(1:3)])
head(round(cor_matrix,2))
par(mar = c(5, 4, 3, 2)) # Adjust bottom, left, top, and right margins
corrplot.mixed(cor_matrix,
order = 'AOE',
tl.cex = 0.6,
sub ="subtitle",
title="Correlation Matrix of Common Mental Disorders Across World",
mar = c(1, 0, 2.3, 0)
)
mtext("Both size and numerica values of correlation are shown:", # add subtitle
side = 3,           # Top side
line = 0.5,         # Position the subtitle
cex = 0.8           # Subtitle font size
)
mtext("Data Source: World Health Organization (WHO)", # add caption
side = 1,           # Bottom side
line = 4,           # Position the caption
adj = 1,            # Right-align the text
cex = 0.7           # Caption font size
)
names(df1) <- str_remove(names(df1), "disorders?") # Remove 'disorder' or 'disorders' from column names
cor_matrix <- cor(df1[,-c(1:3)])
head(round(cor_matrix,2))
par(mar = c(5, 4, 3, 2)) # Adjust bottom, left, top, and right margins
corrplot.mixed(cor_matrix,
order = 'AOE',
tl.cex = 0.6,
sub ="subtitle",
title="Correlation Matrix of Common Mental Disorders Across World",
mar = c(1, 0, 2.3, 0)
)
mtext("Both size and numerica values of correlation are shown:", # add subtitle
side = 3,           # Top side
line = 0.5,         # Position the subtitle
cex = 0.9           # Subtitle font size
)
mtext("Data Source: World Health Organization (WHO)", # add caption
side = 1,           # Bottom side
line = 4,           # Position the caption
adj = 1,            # Right-align the text
cex = 0.7           # Caption font size
)
df2_continent |>
summarise(across(-c(1:3, 11), ~ mean(.x, na.rm = TRUE)))
?geom_boxplot
names(df2_continent) <- str_remove(names(df2_continent), "years old")
df2_continent |>
pivot_longer(
cols = c(4:10),
names_to = "age_group",
values_to = "prevalence"
)
df2_continent |>
pivot_longer(
cols = c(4:5, 7:11, 13),
names_to = "age_group",
values_to = "prevalence"
)
df2_continent |>
pivot_longer(
cols = c(4:5, 7:11, 13),
names_to = "age_group",
values_to = "prevalence"
)|>
ggplot(aes(x = prevalence, y = age_group, color = age_group))+
geom_boxplot()+
theme_minimal()
df2_continent |>
pivot_longer(
cols = c(4:5, 7:11, 13),
names_to = "age_group",
values_to = "prevalence"
)|>
ggplot(aes(y = prevalence, x = age_group, color = age_group))+
geom_boxplot()+
theme_minimal()
df2_continent |>
pivot_longer(
cols = c(4:5, 7:11, 13),
names_to = "age_group",
values_to = "prevalence"
)|>
ggplot(aes(y = prevalence, x = age_group, color = age_group))+
geom_boxplot()+
labs(title = "Average Prevalence of Depression by Age Group", x = "Age Group", y = "Prevalence", fill = "Age Group")+
theme_minimal()
df2_continent |>
pivot_longer(
cols = c(4:5, 7:11, 13),
names_to = "age_group",
values_to = "prevalence"
)|>
ggplot(aes(y = prevalence, x = age_group, color = age_group))+
geom_boxplot()+
labs(title = "Average Prevalence of Depression by Age Group", x = "Age Group", y = "Prevalence", legend = "Age Group")+
theme_minimal()
df2_continent |>
pivot_longer(
cols = c(4:5, 7:11, 13),
names_to = "age_group",
values_to = "prevalence"
)|>
ggplot(aes(y = prevalence, x = age_group, color = age_group))+
geom_boxplot()+
labs(title = "Average Prevalence of Depression by Age Group", x = "Age Group", y = "Prevalence", color = "Age Group")+
theme_minimal()
df2_continent |>
pivot_longer(
cols = c(4:5, 7:11, 13),
names_to = "age_group",
values_to = "prevalence"
)|>
ggplot(aes(y = prevalence, x = age_group, color = age_group))+
geom_boxplot()+
labs(title = "Average Prevalence of Depression by Age Group",
subtitle = "Average across area and year",
caption = "Jady Li",
x = "Age Group",
y = "Prevalence",
color = "Age Group")+
theme_minimal()+
theme(plot.title = element_text(hjust = 0.5, face = "bold", size = 15),
plot.subtitle = element_text(hjust = 0.5))
df2_continent |>
pivot_longer(
cols = c(4:5, 7:11, 13),
names_to = "age_group",
values_to = "prevalence"
)|>
ggplot(aes(y = prevalence, x = age_group, color = age_group))+
geom_boxplot()+
labs(title = "Average Prevalence of Depression by Age Group",
subtitle = "Averaged across region and year",
caption = "Jady Li",
x = "Age Group",
y = "Prevalence",
color = "Age Group")+
theme_minimal()+
theme(plot.title = element_text(hjust = 0.5, face = "bold", size = 15),
plot.subtitle = element_text(hjust = 0.5))
names(df1) <- str_remove(names(df1), "disorders?") # Remove 'disorder' or 'disorders' from column names
cor_matrix <- cor(df1[,-c(1:3)])
head(round(cor_matrix,2))
par(mar = c(5, 4, 3, 2)) # Adjust bottom, left, top, and right margins
corrplot.mixed(cor_matrix,
order = 'AOE',
tl.cex = 0.6,
sub ="subtitle",
title="Correlation Matrix of Common Mental Disorders Across World",
mar = c(1, 0, 2.3, 0)
)
mtext("Both size and numerica values of correlation are shown:", # add subtitle
side = 3,                                                # Top side
line = 0.5,                                              # Position the subtitle
cex = 0.9                                                # Subtitle font size
)
mtext("Jady Li",            # add caption
side = 1,           # Bottom side
line = 4,           # Position the caption
adj = 1,            # Right-align the text
cex = 0.7           # Caption font size
)
::: {.callout-note appearance="simple"}
names(df1) <- str_extract(names(df1), "^[^\\(]+") # get rid of parenthesis in disorder names
prevalence <- df1 |>
summarise(across(-c(1:3), ~ mean(.x, na.rm = TRUE))) |>  # calculate average percent for each type of mental disorder
pivot_longer(
cols = everything(),
names_to = "Mental Disorder Type",
values_to = "Average Percent"
) # change to long data
prevalence <- as.data.frame(prevalence) |>
arrange(desc(`Average Percent`))
ggplot(prevalence, aes(y = reorder(`Mental Disorder Type`, `Average Percent`), x = `Average Percent`))+
geom_bar(stat = "identity", fill = "skyblue")+
labs(title = "Figure 1: Prevalance of Mental Disorder Types Around World",
subtitle = "Common Mental Disorders are included",
caption = "Jady Li",
y = NULL)+
theme_minimal()+
theme(plot.title = element_text(hjust = 0.5, face = "bold", size = 15),
plot.subtitle = element_text(hjust = 0.5))
#| message: false
#| warning: false
df2_continent |>
group_by(continent, Year) |>
summarise(across(c(4:10), ~ mean(.x, na.rm = TRUE))) |>
select(-`All ages `) |>
pivot_longer(
cols = -c(1:2),
names_to = "Age",
values_to = "Avg_Percent"
) |>
ggplot(aes(x = Year, y = Avg_Percent, color = Age))+
geom_line()+
facet_wrap(~continent, ncol = 3)+
theme_bw()+
labs(title = "Depression Prevalence by Age Group across Continents",
subtitle = "Similar trend of prevalence in different areas of the world",
caption = "Figure 4",
y = "Average Prevalence Percent")+
theme(plot.title = element_text(hjust = 0.5, face = "bold", size = 15),
plot.subtitle = element_text(hjust = 0.5))
